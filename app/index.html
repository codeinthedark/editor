<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code in the Dark</title>
  <script>
      document.onreadystatechange = function() {
          if(document.readyState === "interactive") {
              localStorage.removeItem('content');
          }
      }

      window.onload = function() {
          var timer = document.getElementById('timer');
          var timerStarted = false;
          timer.innerHTML = '15' + ":" + '00';
          document.addEventListener('keydown', function(event) {
              if (!timerStarted) {
                  startTimer();
                  timerStarted = true;
              }
          }, false);

          document.addEventListener('click', function(event) {
              if (!timerStarted) {
                  startTimer();
                  timerStarted = true;
              }
          }, false);

          document.getElementById('time-left').addEventListener('click', function(event) {
              event.stopPropagation();
              if (timer.innerHTML === "COMPLETED") {
                  timer.innerHTML = '15' + ":" + '00';
                  timerStarted = false;
              }
          })

          function startTimer() {
              var presentTime = timer.innerHTML;
              var timeArray = presentTime.split(/[:]+/);
              var m = timeArray[0];
              var s = checkSecond((timeArray[1] - 1));
              if(s==59){m=m-1}
              if(m<0){
                  alert("TIME'S UP, HANDS UP!!!")
                  timer.innerHTML = "COMPLETED"
                  return;
              }

              timer.innerHTML =
                m + ":" + s;
              setTimeout(startTimer, 1000);
            }

            function checkSecond(sec) {
              if (sec < 10 && sec >= 0) {sec = "0" + sec}; // add zero in front of numbers < 10
              if (sec < 0) {sec = "59"};
              return sec;
            }
      }
  </script>
  <script src="bundle.js" inline></script>
</head>
<body>
  <div class="background"></div>
  <canvas class="canvas-overlay"></canvas>
  <pre id="editor"></pre>
  <div class="streak-container">
      <div class="current">Combo</div>
      <div class="counter">0</div>
      <div class="bar"></div>
      <div class="exclamations"></div>
  </div>
  <div class="reference-screenshot-container">
    <span>Reference</span>
    <div class="reference-screenshot" style="background-image:url(assets/page.png);"></div>
  </div>

  <div class="name-tag">
    Unnamed
  </div>
  <div class="time-left" id="time-left">
    Time: <p id="timer"></p>
  </div>

  <div class="power-mode-indicator">
    <h1>POWER MODE!</h1>
  </div>

  <div class="instructions-container">
    <iframe class="instructions" src="assets/instructions.html"></iframe>
  </div>

  <div class="button-bar">
    <button class="finish-button">Finish</button>
    <button class="instructions-button">Instructions</button>
  </div>

  <iframe class="result" src="assets/result.html" frameborder="0"><iframe>
</body>
</html>
